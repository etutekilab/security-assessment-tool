<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark light">
    
    <!-- Load dependencies first -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Global error handler -->
    <script>
        window.handleInitError = function(error) {
            console.error('Initialization error:', error);
            const banner = document.createElement('div');
            banner.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                background: #ff4444;
                color: white;
                padding: 10px;
                text-align: center;
                z-index: 9999;
            `;
            banner.textContent = `⚠️ ${error.message}`;
            document.body.appendChild(banner);
        };
    </script>

    <!-- Load environment -->
    <script>
        // Create global config object
        window.APP_CONFIG = {};
        
        // Load environment from deployed env.js
        const envScript = document.createElement('script');
        envScript.src = 'env.js';
        envScript.onerror = () => {
            window.handleInitError(new Error('Failed to load environment configuration'));
        };
        document.head.appendChild(envScript);
    </script>
    
    <!-- Initialize app after environment loads -->
    <script>
        envScript.onload = () => {
            if (!window.env) {
                window.handleInitError(new Error('Environment not properly loaded'));
                return;
            }
            
            // Initialize Supabase
            window.APP_CONFIG.supabase = createClient(
                window.env.SUPABASE_URL,
                window.env.SUPABASE_ANON_KEY
            );
            
            // Initialize OpenAI config
            window.APP_CONFIG.openai = {
                apiKey: window.env.OPENAI_API_KEY,
                model: 'gpt-4-0125-preview',
                baseURL: 'https://api.openai.com/v1'
            };
            
            // Load main scripts
            ['config.js', 'script.js'].forEach(src => {
                const script = document.createElement('script');
                script.src = src;
                script.onerror = () => window.handleInitError(new Error(`Failed to load ${src}`));
                document.head.appendChild(script);
            });
        };
    </script>
    
    <title>Cybersecurity Assessment</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <i class="fas fa-shield-alt"></i>
                <a href="https://www.etutekilab.com" target="_blank" rel="noopener">Etuteki_Lab</a>
            </div>
        </nav>
    </header>

    <main>
        <div class="container">
            <h1></h1>
            <p class="intro"></p>
            
            <div id="assessment-form">
                <!-- Progress bar and sections will be dynamically loaded here -->
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 All rights reserved.</p>
            <p class="powered-by">
                Powered by <a href="https://www.etutekilab.com" target="_blank" rel="noopener">Etuteki Lab</a>
            </p>
        </div>
    </footer>
</body>
</html> 