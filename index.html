<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark light">
    
    <!-- Load dependencies first -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Load environment and config -->
    <script src="env.js"></script>
    <script src="config.js"></script>
    
    <!-- Initialize app -->
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Initialize config first
                await initializeConfig();
                console.log('Config initialized');
                
                // Initialize the form
                initializeAssessment();
                console.log('Assessment form initialized');
                
                // Test API connections
                const connectionsOk = await testAPIConnections();
                if (!connectionsOk) {
                    throw new Error('API connections failed');
                }
                
                // Enable API features if connections are good
                document.querySelectorAll('.ai-notes-btn').forEach(btn => {
                    btn.disabled = false;
                    btn.title = 'Get AI suggestions';
                });
                
                document.querySelector('.submit-btn')?.removeAttribute('disabled');
                
                console.log('App initialized successfully');
            } catch (error) {
                console.error('Initialization error:', error);
                showErrorBanner(error.message);
            }
        });

        function showErrorBanner(message) {
            const banner = document.createElement('div');
            banner.className = 'error-banner';
            banner.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                background: #ff4444;
                color: white;
                padding: 10px;
                text-align: center;
                z-index: 9999;
            `;
            banner.textContent = `⚠️ ${message}`;
            document.body.appendChild(banner);
        }
    </script>
    
    <!-- Load main application script -->
    <script src="script.js"></script>
    
    <title>Cybersecurity Assessment</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <i class="fas fa-shield-alt"></i>
                <a href="https://www.etutekilab.com" target="_blank" rel="noopener">Etuteki_Lab</a>
            </div>
        </nav>
    </header>

    <main>
        <div class="container">
            <h1></h1>
            <p class="intro"></p>
            
            <div id="assessment-form">
                <!-- Progress bar and sections will be dynamically loaded here -->
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 All rights reserved.</p>
            <p class="powered-by">
                Powered by <a href="https://www.etutekilab.com" target="_blank" rel="noopener">Etuteki Lab</a>
            </p>
        </div>
    </footer>
</body>
</html> 